<!-- @format -->
<div class="chat-page" *ngIf="project">
  <div class="chat-page__main main">
    <header class="main__header">
      <div class="main__project">
        <app-avatar class="main__avatar" [url]="project.imageAddress" [size]="26"></app-avatar>
        <div class="main__name text-heading-4">{{ project.name }}</div>
      </div>
      <div class="main__meta">
        <ul
          class="main__members-list"
          [style.width]="project.collaborators.length * 10 + 10 + 'px'"
        >
          <li
            class="main__member-avatar"
            *ngFor="let member of project.collaborators; index as index"
            [style.left]="index * -10 + 'px'"
            [style.z-index]="index"
          >
            <app-avatar [url]="member.avatar" [size]="20"></app-avatar>
          </li>
        </ul>
        <div class="main__count">
          {{ project.collaborators.length }}
          {{ project.collaborators.length | pluralize: ["Участник", "Участника", "Участников"] }}
        </div>
        <!--<div class="main__dot">•</div>
        <div class="main__count-online">{{ membersOnlineCount }} online</div>-->
      </div>
    </header>
    <app-chat-window
      class="main__chat"
      [messages]="messages"
      [typingPersons]="typingPersons"
      (submit)="onSubmitMessage($event)"
      (edit)="onEditMessage($event)"
      (delete)="onDeleteMessage($event)"
    ></app-chat-window>
  </div>
  <aside class="chat-page__aside">
    <div class="chat-members">
      <header class="chat-members__header">
        <h2 class="chat-members__title text-bold-body-16">Участники</h2>
      </header>
      <ul class="chat-members__list">
        <li class="chat-members__item" *ngFor="let member of project.collaborators">
          <a class="member" [routerLink]="['/office/profile', member.userId]">
            <app-avatar class="member__avatar" [url]="member.avatar" [size]="30"></app-avatar>
            <span class="member__name text-bold-body-14">
              {{ member.firstName }} {{ member.lastName }}
            </span>
            <span *ngIf="currentUserId === member.userId" class="member__i text-body-14">(Вы)</span>
          </a>
        </li>
      </ul>
    </div>
    <div class="files">
      <h2 class="files__title text-bold-body-16">Файлы</h2>
      <ul class="files__list">
        <li class="files__item" *ngFor="let file of chatFiles">
          <app-file-item
            [name]="file.name"
            [link]="file.link"
            [type]="file.extension"
            [size]="file.size"
          ></app-file-item>
        </li>
      </ul>
    </div>
  </aside>
</div>
