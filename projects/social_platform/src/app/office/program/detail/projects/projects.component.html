<!-- @format -->

<div class="page" #projectsRoot>
  @if (program$ | async; as program) {
  <app-program-head [program]="program"></app-program-head>

  <div class="page__search">
    <form [formGroup]="searchForm">
      <app-search formControlName="search"></app-search>
    </form>
  </div>

  }
  <div class="page__list--wrapper">
    <div class="filter-toggle page__filter-toggle" (click)="isFilterOpen = !isFilterOpen">
      <span>Фильтр</span>
      <i appIcon icon="filter" appSquare="34"></i>
    </div>
    <ul class="page__list">
      @for (p of searchedProjects; track p.id) {
      <li class="page__item">
        <a [routerLink]="['/office/projects', p.id]">
          <app-project-card [project]="p"></app-project-card>
        </a>
      </li>
      }
    </ul>

    <div class="filter page__filter" [class.page__filter--open]="isFilterOpen">
      <div class="filter__overlay" (click)="isFilterOpen = false"></div>
      <div class="filter__body" #filterBody>
        <div
          class="filter__bar"
          (touchstart)="onSwipeStart($event)"
          (touchmove)="onSwipeMove($event)"
          (touchend)="onSwipeEnd($event)"
        ></div>
        <app-projects-filter
          (filtersLoaded)="onFiltersLoaded($event)"
          (closeFilter)="closeFilter()"
        ></app-projects-filter>
      </div>
    </div>
  </div>
</div>
