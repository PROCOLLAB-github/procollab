<!-- @format -->

<div class="profile__wrapper--education" [formGroup]="profileForm">
  <div class="profile__column">
    <fieldset>
      <label for="skills" class="field-label">мои навыки</label>
      <div class="skills-field">
        <app-autocomplete-input
          class="skills-field__input"
          placeholder="python"
          searchIcon="box"
          [suggestions]="inlineSkills()"
          fieldToDisplay="name"
          [forceSelect]="true"
          [clearInputOnSelect]="true"
          (searchStart)="onSearchSkill($event)"
          (optionSelected)="onAddSkill($event)"
          (openSkillsFunc)="toggleSkillsGroupsModal()"
        ></app-autocomplete-input>
      </div>
    </fieldset>

    <div class="profile__column">
      @if (profileForm.get("skills"); as skills) {
      <fieldset class="skills-basket">
        <app-skills-basket
          formControlName="skills"
          [error]="skills | controlError"
        ></app-skills-basket>
      </fieldset>
      }
    </div>
  </div>

  <div class="profile__column">
    @if (showLanguageFields()) {
    <div class="profile__column--date">
      @if (profileForm.get("language"); as language) {
      <fieldset>
        <label for="languageName" class="field-label">язык</label>
        <app-select
          size="big"
          [selectedId]="selectedLanguageId()"
          formControlName="language"
          placeholder="английский"
          [options]="languageList"
        >
          <i appIcon icon="arrow-no-body" appSquare="32" class="arrow-list__end"></i>
        </app-select>

        @if (language | controlError: "required") {
        <div class="text-body-10 error">
          {{ errorMessage.VALIDATION_REQUIRED }}
        </div>
        }
      </fieldset>
      } @if (profileForm.get("languageLevel"); as languageLevel) {
      <fieldset>
        <label for="languagLevel" class="field-label">уровень</label>
        <app-select
          size="big"
          [selectedId]="selectedLanguageLevelId()"
          formControlName="languageLevel"
          placeholder="B1"
          [options]="languageLevelList"
        >
          <i appIcon icon="arrow-no-body" appSquare="32" class="arrow-list__end"></i>
        </app-select>

        @if (languageLevel | controlError: "required") {
        <div class="text-body-10 error">
          {{ errorMessage.VALIDATION_REQUIRED }}
        </div>
        }
      </fieldset>
      }
    </div>
    }

    <span class="text-body-10" style="color: var(--black)"
      >количество добавляемых языков не более 4-х</span
    >
    <app-button
      customTypographyClass="text-body-12"
      size="big"
      appearance="outline"
      [disabled]="
        showLanguageFields() &&
        !isLanguageDirty &&
        (languageItems().length === 4 || userLanguages.length === 4)
      "
      [ngStyle]="{
          opacity: showLanguageFields() && !isLanguageDirty ? '0.6' : '1',
          cursor: showLanguageFields() && !isLanguageDirty ? 'not-allowed' : 'pointer',
        }"
      (click)="addLanguage()"
    >
      <span>{{ editLanguageClick() ? "сохранить изменения" : "добавить язык" }}</span>
      <i appIcon icon="plus" appSquare="6"></i>
    </app-button>

    <div class="profile__language--list">
      @if(languageItems().length || userLanguages.length){ @for (languageItem of
      userLanguages.value; track $index) {
      <div class="profile__education--info">
        <div class="education__title">
          <p class="text-body-12">
            {{ languageItem.language }}
          </p>

          <div class="profile__action--icons" style="flex-direction: row">
            <div class="edit-icon" (click)="editLanguage($index)">
              <i appIcon icon="edit-pen" appSquare="10"></i>
            </div>

            <div class="basket-icon" (click)="removeLanguage($index)">
              <i appIcon icon="basket" appSquare="10"></i>
            </div>
          </div>
        </div>

        <p class="text-body-10 education__text" style="margin-top: 5px">
          {{ languageItem.languageLevel }}
        </p>
      </div>
      } }
    </div>
  </div>
</div>
