<!-- @format -->

<div class="auth register">
  <div class="auth__greeting">
    <h3 class="auth__title auth__title--register">
      @if (step === "credentials") {
        <ng-container>
          –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ Procollab!&nbsp;üëã<br />
          –° –Ω–∞–º–∏ –∏–¥–µ–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å—é&nbsp;üöÄ
        </ng-container>
      } @else if (step === "info") {
        <ng-container>
          PROCOLLAB - —ç—Ç–æ –Ω–µ —Ç–æ–ª—å–∫–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞, –Ω–æ –∏ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ —Å–∞–º—ã—Ö –∑–∞—Ä—è–∂–µ–Ω–Ω—ã—Ö —à–∫–æ–ª—å–Ω–∏–∫–æ–≤ –∏
          —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
        </ng-container>
      }
    </h3>
    <p class="auth__info">
      @if (step === "credentials") {
        <ng-container> –î–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ </ng-container>
      } @else if (step === "info") {
        <ng-container>
          –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ —Å–µ–±–µ, —á—Ç–æ–±—ã –º—ã –∑–Ω–∞–ª–∏, –∫–∞–∫ –∫ –≤–∞–º –æ–±—Ä–∞—â–∞—Ç—å—Å—è
        </ng-container>
      }
    </p>
  </div>
  <form class="auth__wrapper" [formGroup]="registerForm" (ngSubmit)="onSubmit()">
    @if (step === "credentials") {
      <ng-container>
        @if (registerForm.get("email"); as email) {
          <fieldset class="auth__field">
            <label for="email" class="field-label">–ü–æ—á—Ç–∞</label>
            <app-input
              [error]="(email | controlError) && credsSubmitInitiated"
              id="email"
              type="email"
              formControlName="email"
              placeholder="mail@example.ru"
            ></app-input>
            @if (credsSubmitInitiated) {
              <ng-container>
                @if (email | controlError: "required") {
                  <div class="text-body-14 error">
                    {{ errorMessage.VALIDATION_REQUIRED }}
                  </div>
                }
                @if (email | controlError: "email") {
                  <div class="text-body-14 error">
                    {{ errorMessage.VALIDATION_EMAIL }}
                  </div>
                }
              </ng-container>
            }
          </fieldset>
        }
        @if (registerForm.get("password"); as password) {
          <fieldset class="auth__field">
            <label for="passowrd" class="field-label">–ü–∞—Ä–æ–ª—å</label>
            <app-input
              [error]="(password | controlError) && credsSubmitInitiated"
              id="passowrd"
              type="password"
              formControlName="password"
              placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å"
            ></app-input>
            <app-input
              class="register__repeated-password"
              [error]="(password | controlError) && credsSubmitInitiated"
              id="repeatedPassword"
              type="password"
              formControlName="repeatedPassword"
              placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å"
            ></app-input>
            @if (credsSubmitInitiated) {
              <ng-container>
                @if (password | controlError: "required") {
                  <div class="text-body-14 error">
                    {{ errorMessage.VALIDATION_REQUIRED }}
                  </div>
                }
                @if (password | controlError: "minlength") {
                  <div class="text-body-14 error">
                    @if (password.errors) {
                      {{ errorMessage.VALIDATION_TOO_SHORT }}
                      {{ password.errors["minlength"]["requiredLength"] }}
                    }
                  </div>
                }
                @if (password | controlError: "unMatch") {
                  <div class="text-body-14 error">
                    {{ errorMessage.VALIDATION_PASSWORD_UNMATCH }}
                  </div>
                }
              </ng-container>
            }
          </fieldset>
        }
      </ng-container>
    } @else if (step === "info") {
      <ng-container>
        <div class="auth__row">
          @if (registerForm.get("firstName"); as name) {
            <fieldset class="auth__field">
              <label for="name" class="field-label">–ò–º—è</label>
              <app-input
                [error]="(name | controlError) && infoSubmitInitiated"
                id="name"
                type="text"
                formControlName="firstName"
                placeholder="–ò–≤–∞–Ω"
              ></app-input>
              @if (infoSubmitInitiated) {
                <ng-container>
                  @if (name | controlError: "required") {
                    <div class="text-body-14 error">
                      {{ errorMessage.VALIDATION_REQUIRED }}
                    </div>
                  }
                  @if (name | controlError: "invalidLanguage") {
                    <div class="text-body-14 error">
                      {{ errorMessage.VALIDATION_LANGUAGE }}
                    </div>
                  }
                </ng-container>
              }
            </fieldset>
          }
          @if (registerForm.get("lastName"); as surname) {
            <fieldset class="auth__field">
              <label for="surname" class="field-label">–§–∞–º–∏–ª–∏—è</label>
              <app-input
                [error]="(surname | controlError) && infoSubmitInitiated"
                id="surname"
                type="text"
                formControlName="lastName"
                placeholder="–ò–≤–∞–Ω–æ–≤"
              ></app-input>
              @if (infoSubmitInitiated) {
                <ng-container>
                  @if (surname | controlError: "required") {
                    <div class="text-body-14 error">
                      {{ errorMessage.VALIDATION_REQUIRED }}
                    </div>
                  }
                  @if (surname | controlError: "invalidLanguage") {
                    <div class="text-body-14 error">
                      {{ errorMessage.VALIDATION_LANGUAGE }}
                    </div>
                  }
                </ng-container>
              }
            </fieldset>
          }
        </div>
        @if (registerForm.get("birthday"); as birthday) {
          <fieldset class="auth__field">
            <label for="birthday" class="field-label">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
            <app-input
              id="birthday"
              [error]="(birthday | controlError) && infoSubmitInitiated"
              type="text"
              mask="00.00.0000"
              placeholder="–î–î.–ú–ú.–ì–ì–ì–ì"
              formControlName="birthday"
            ></app-input>
            @if (infoSubmitInitiated) {
              <ng-container>
                @if (birthday | controlError: "required") {
                  <div class="text-body-14 error">
                    {{ errorMessage.VALIDATION_REQUIRED }}
                  </div>
                }
                @if (birthday | controlError: "tooYoung") {
                  <div class="text-body-14 error">
                    @if (birthday.errors) {
                      {{ errorMessage.MINIMAL_AGE }}
                      {{ birthday.errors["tooYoung"]["requiredAge"] }} –ª–µ—Ç
                    }
                  </div>
                }
                @if (birthday | controlError: "invalidDateFormat") {
                  <div class="text-body-14 error">
                    {{ errorMessage.INVALID_DATE }}
                  </div>
                }
              </ng-container>
            }
          </fieldset>
        }
      </ng-container>
    }
    @if (serverErrors) {
      <div class="text-body-14 error">
        @for (e of serverErrors; track $index) {
          <p>{{ e }}</p>
        }
      </div>
    }
    @if (step === "credentials") {
      <div class="register__agreement">
        <app-checkbox [(checked)]="registerAgreement"></app-checkbox>
        <span (click)="registerAgreement = !registerAgreement">
          –Ø –ø—Ä–æ—á–∏—Ç–∞–ª
          <a href="/assets/downloads/auth/shared/–ü–æ–ª–∏—Ç–∏–∫–∞_–æ–±—Ä–∞–±–æ—Ç–∫–∏_–ø–µ—Ä—Å_–¥–∞–Ω–Ω—ã—Ö_2022.docx" download>
            —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ
          </a>
          –∏ –¥–∞—é —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞&nbsp;–æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö&nbsp;–¥–∞–Ω–Ω—ã—Ö
        </span>
      </div>
      <app-button
        type="submit"
        class="auth__button"
        customTypographyClass="auth__button-typography"
      >
        –î–∞–ª–µ–µ
      </app-button>
    } @else if ("info") {
      <app-button [loader]="registerIsSubmitting" type="submit" class="auth__button">
        –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç
      </app-button>
    }
    <p class="auth__toggle">–ï—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a routerLink="/auth/login">–í–æ–π–¥–∏—Ç–µ</a></p>
  </form>
</div>
